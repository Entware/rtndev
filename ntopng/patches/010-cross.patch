--- a/configure.ac.in
+++ b/configure.ac.in
@@ -110,7 +110,7 @@ fi
 CFLAGS="${CFLAGS} -I${HERE} -I${HERE}/include"
 CXXFLAGS="${CXXFLAGS} -I${HERE} -I${HERE}/include"
 
-CXXFLAGS="${CXXFLAGS} -Wno-address-of-packed-member -Wno-unused-function"
+CXXFLAGS="${CXXFLAGS} -Wno-unused-function"
 
 dnl> MacOS brew.sh
 HOMEBREW_DIR=/opt/homebrew
@@ -237,23 +237,23 @@ if test "${with_nedge+set}" = set; then
   LIBS="${LIBS} -lnetfilter_queue -lnfnetlink -lnetfilter_conntrack"
 fi
 
-if test -d "/usr/local/include"; then
-  CFLAGS="${CFLAGS} -I/usr/local/include"
-  CXXFLAGS="${CXXFLAGS} -I/usr/local/include"
-fi
-
-if test -d "/usr/local/lib"; then
-  LIBS="${LIBS} -L/usr/local/lib"
-fi
-
-if test -d /opt/local/include; then :
-  CFLAGS="${CFLAGS} -I/opt/local/include"
-  CXXFLAGS="${CXXFLAGS} -I/opt/local/include"
-fi
-
-if test -d /opt/local/lib; then :
-  LIBS="${LIBS} -L/opt/local/lib"
-fi
+#if test -d "/usr/local/include"; then
+#  CFLAGS="${CFLAGS} -I/usr/local/include"
+#  CXXFLAGS="${CXXFLAGS} -I/usr/local/include"
+#fi
+
+#if test -d "/usr/local/lib"; then
+#  LIBS="${LIBS} -L/usr/local/lib"
+#fi
+
+#if test -d /opt/local/include; then :
+#  CFLAGS="${CFLAGS} -I/opt/local/include"
+#  CXXFLAGS="${CXXFLAGS} -I/opt/local/include"
+#fi
+
+#if test -d /opt/local/lib; then :
+#  LIBS="${LIBS} -L/opt/local/lib"
+#fi
 
 if [ test -f /usr/bin/lsb_release ]; then
   CODENAME=`/usr/bin/lsb_release -c|cut -f 2`
@@ -387,7 +387,7 @@ fi
 pkg-config --exists libssl
 if test "$?" -ne 1; then
   AC_DEFINE_UNQUOTED(NO_SSL_DL, 1, [has openssl])
-  SSL_INC="`pkg-config --cflags libssl` -I/usr/include/openssl"
+  SSL_INC="`pkg-config --cflags libssl`"
   SSL_LIB="`pkg-config --libs libssl` -lssl -lcrypto"
 else
   dnl Workaround for MacOS Brew
@@ -467,7 +467,7 @@ else
   APP=ntopng
 fi
 
-CLICKHOUSE_HOME=${PWD}/third-party/clickhouse-cpp
+CLICKHOUSE_HOME=
 
 if test -d "pro"; then :
 AC_MSG_RESULT(yes)
@@ -562,13 +562,13 @@ AC_CHECK_LIB(resolv, inet_aton)
 HIREDIS_INC=
 HIREDIS_LIB=
 AS_VAR_IF(with_hiredis, yes, [
-    if test -f "${HOME}/hiredis/libhiredis.a" ; then :
-      HIREDIS_INC="-I${HOME}/hiredis/"
-      HIREDIS_LIB="${HOME}/hiredis/libhiredis.a"
-    else
+#    if test -f "${HOME}/hiredis/libhiredis.a" ; then :
+#      HIREDIS_INC="-I${HOME}/hiredis/"
+#      HIREDIS_LIB="${HOME}/hiredis/libhiredis.a"
+#    else
       pkg-config --exists hiredis
       if test "$?" -ne 1; then
-      HIREDIS_INC="`pkg-config --cflags hiredis` -I/usr/include/hiredis"
+      HIREDIS_INC="`pkg-config --cflags hiredis`"
       if test $SYSTEM = "FreeBSD" && $FREEBSD_VERSION != "15"; then
 	dnl> Note: on freebsd 15 .a is not installed
         HIREDIS_LIB="/usr/local/lib/libhiredis.a"
@@ -579,7 +579,7 @@ AS_VAR_IF(with_hiredis, yes, [
       echo "Please install hiredis package prerequisite"
       exit -1
       fi
-   fi
+#   fi
 
    AC_DEFINE_UNQUOTED(HAVE_HIREDIS, 1, [Hiredis support
    ])
@@ -854,8 +854,8 @@ fi
 
 PWD=${HERE}
 AC_DEFINE_UNQUOTED(PACKAGE_RELEASE, "r$GIT_RELEASE", [GIT release of this package])
-AC_DEFINE_UNQUOTED(PACKAGE_MACHINE, "$MACHINE", [Architecture of this host])
-AC_DEFINE_UNQUOTED(PACKAGE_OS, "${OS}", [OS Name])
+AC_DEFINE_UNQUOTED(PACKAGE_MACHINE, "${ARCH}", [Architecture of this host])
+AC_DEFINE_UNQUOTED(PACKAGE_OS, "Linux", [OS Name])
 AC_SUBST(PWD)
 AC_SUBST(MACHINE)
 AC_SUBST(SYSTEM)
@@ -918,7 +918,6 @@ AC_SUBST(STABLE_SUFFIX)
 AC_SUBST(LIBS)
 AC_SUBST(FUZZ_MAKEFILE_INC)
 AC_SUBST(FUZZ_OBJECTS)
-AC_SUBST(CLICKHOUSE_HOME)
 AC_CONFIG_HEADERS(include/config.h)
 AC_CONFIG_FILES(packages/ntopng.spec)
 AC_CONFIG_FILES(packages/ntopng-data.spec)
--- a/Makefile.in
+++ b/Makefile.in
@@ -32,16 +32,16 @@ MONGOOSE_INC=-I$(MONGOOSE_HOME)
 LUA_PLATFORM=generic
 LUA_HOME=${PWD}/third-party/lua-5.4.6
 LUA_INC=-I$(LUA_HOME)/src
-LUA_LIB=$(LUA_HOME)/src/liblua.a
+LUA_LIB=-llua5.4
 
 CLICKHOUSE_HOME=@CLICKHOUSE_HOME@
 CLICKHOUSE_INC=
 CLICKHOUSE_LIB=
 CLICKHOUSE_DEP_LIBS=
 #ifeq ($(OS),Linux)
-CLICKHOUSE_INC=-I$(CLICKHOUSE_HOME) -I$(CLICKHOUSE_HOME)/contrib/absl
-CLICKHOUSE_LIB=$(CLICKHOUSE_HOME)/build/clickhouse/libclickhouse-cpp-lib.a
-CLICKHOUSE_DEP_LIBS=$(CLICKHOUSE_HOME)/build/contrib/cityhash/cityhash/libcityhash.a $(CLICKHOUSE_HOME)/build/contrib/lz4/lz4/liblz4.a
+#CLICKHOUSE_INC=-I$(CLICKHOUSE_HOME) -I$(CLICKHOUSE_HOME)/contrib/absl
+#CLICKHOUSE_LIB=$(CLICKHOUSE_HOME)/build/clickhouse/libclickhouse-cpp-lib.a
+#CLICKHOUSE_DEP_LIBS=$(CLICKHOUSE_HOME)/build/contrib/cityhash/cityhash/libcityhash.a $(CLICKHOUSE_HOME)/build/contrib/lz4/lz4/liblz4.a
 #endif
 
 ifeq ($(OS),Linux)
@@ -95,12 +95,12 @@ endif
 
 ######
 TARGET = ntopng
-LIBS = $(NDPI_LIB) $(LIBPCAP) $(LUA_LIB) $(CLICKHOUSE_LIB) $(CLICKHOUSE_DEP_LIBS) $(LIBRRDTOOL_LIB) $(ZEROMQ_LIB) $(JSON_LIB) $(SNMP_LIB) @MAXMINDDB_LIBS@ $(SODIUM_LIB) @NTOPCLOUD_LIB@ @HIREDIS_LIB@ @SQLITE_LIB@ @RADCLI_LIB@ @EXPAT_LIB@ @SSL_LIB@ @ZMQ_LIBS@ @LINK_OPTS@ @LDFLAGS@ @PRO_LIBS@ @LIBS@ $(ZSTD_LIB) @JE@  -lm -lpthread
+LIBS = $(NDPI_LIB) $(LIBPCAP) $(LUA_LIB) $(LIBRRDTOOL_LIB) $(ZEROMQ_LIB) $(JSON_LIB) $(SNMP_LIB) @MAXMINDDB_LIBS@ $(SODIUM_LIB) @NTOPCLOUD_LIB@ @HIREDIS_LIB@ @SQLITE_LIB@ @RADCLI_LIB@ @EXPAT_LIB@ @SSL_LIB@ @ZMQ_LIBS@ @LINK_OPTS@ @LDFLAGS@ @PRO_LIBS@ @LIBS@ $(ZSTD_LIB) @JE@  -lm -lpthread
 CC := @CC@
 CXX := @CXX@
 CPPFLAGS := @CPPFLAGS@
 CFLAGS := @CFLAGS@
-CXXFLAGS = $(CFLAGS) -std=c++17 @HIREDIS_INC@ @MAXMINDDB_CFLAGS@ $(MONGOOSE_INC) $(JSON_INC) $(SNMP_INC) $(SODIUM_INC) $(NDPI_INC) $(LUA_INC) $(CLICKHOUSE_INC) $(LIBRRDTOOL_INC) $(ZEROMQ_INC) @ZMQ_CFLAGS@ @CXXFLAGS@ -I$(HTTPCLIENT_INC) @SSL_INC@ @PRO_INCS@ -DDATA_DIR='"$(datadir)"' # -D_GLIBCPP_DEBUG
+CXXFLAGS = $(CFLAGS) -std=c++17 @HIREDIS_INC@ @MAXMINDDB_CFLAGS@ $(MONGOOSE_INC) $(JSON_INC) $(SNMP_INC) $(SODIUM_INC) $(NDPI_INC) $(LUA_INC) $(LIBRRDTOOL_INC) $(ZEROMQ_INC) @ZMQ_CFLAGS@ @CXXFLAGS@ -I$(HTTPCLIENT_INC) @SSL_INC@ @PRO_INCS@ -DDATA_DIR='"$(datadir)"' # -D_GLIBCPP_DEBUG
 ######
 # ntopng-1.0_1234.x86_64.rpm
 PLATFORM = `uname -m`
@@ -160,18 +160,14 @@ test_alert_engine: $(OBJECTS_NO_MAIN) $(
 	$(CXX) $(CPPFLAGS) $(CXXFLAGS) $(LDFLAGS) $(OBJECTS_NO_MAIN) -Wall $(LIBS) -o $@
 
 $(LUA_LIB):
-	$(MAKE) -C $(LUA_HOME) $(LUA_PLATFORM)
 
 $(CLICKHOUSE_LIB):
-	cd $(CLICKHOUSE_HOME) && cmake -B build -DWITH_OPENSSL=ON .
-	cd $(CLICKHOUSE_HOME) && cmake --build build
 
 $(ZEROMQ_LIB):
 	cd $(ZEROMQ_HOME); ./configure --without-documentation --without-libsodium; $(MAKE)
 
 # --disable-rrd_graph
 $(LIBRRDTOOL_LIB):
-	cd $(LIBRRDTOOL_HOME); ./configure --disable-libdbi --disable-libwrap --disable-rrdcgi --disable-libtool-lock --disable-nls --disable-rpath --disable-perl --disable-ruby --disable-lua --disable-tcl --disable-python --disable-dependency-tracking --disable-rrd_graph ; cd src; $(MAKE) librrd_th.la
 
 hooks/.enabled:
 	git config core.hooksPath hooks || true
