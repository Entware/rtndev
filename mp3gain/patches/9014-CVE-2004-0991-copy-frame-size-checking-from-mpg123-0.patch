From: Simon McVittie <smcv@debian.org>
Date: Sun, 16 Mar 2014 21:46:34 +0000
Subject: CVE-2004-0991: copy frame size checking from mpg123/0.59r-18

Author: Daniel Kobras
Origin: vendor, Debian (mpg123/0.59r-18)
---
 mpglibDBL/common.c | 5 +++++
 1 file changed, 5 insertions(+)

diff --git a/mpglibDBL/common.c b/mpglibDBL/common.c
index 1e97adc..3172235 100644
--- a/mpglibDBL/common.c
+++ b/mpglibDBL/common.c
@@ -229,6 +229,11 @@ int decode_header(struct frame *fr,unsigned long newhead)
         fprintf(stderr,"Sorry, layer %d not supported\n",fr->lay); 
         return (0);
     }
+    if (fr->framesize > MAXFRAMESIZE) {
+      fprintf(stderr,"Frame size too big: %d\n", fr->framesize+4-fr->padding);
+      return (0);
+    }
+
     /*    print_header(fr); */
 
     return 1;
