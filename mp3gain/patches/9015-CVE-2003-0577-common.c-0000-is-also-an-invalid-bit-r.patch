From: Simon McVittie <smcv@debian.org>
Date: Sun, 16 Mar 2014 21:55:22 +0000
Subject: CVE-2003-0577: common.c: 0000 is also an invalid bit rate

According to Daniel Kobras on #201698, this patch is unnecessary...
but it seems better to be careful, since our mpglib is not quite
the same as the one in mpg123.

Origin: vendor, Connectiva
See-also: http://lwn.net/Alerts/39916/
See-also: http://www.securityfocus.com/bid/6629
See-also: http://www.securityfocus.com/archive/1/306903
See-also: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=201698
---
 mpglibDBL/common.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/mpglibDBL/common.c b/mpglibDBL/common.c
index 3172235..97a96b4 100644
--- a/mpglibDBL/common.c
+++ b/mpglibDBL/common.c
@@ -125,8 +125,8 @@ int head_check(unsigned long head,int check_layer)
       if (nLayer != check_layer) return FALSE;
   }
 
-  if( ((head>>12)&0xf) == 0xf) {
-    /* bits 16,17,18,19 = 1111  invalid bitrate */
+  if( ((head>>12)&0xf) == 0xf || ((head>>12)&0xf) == 0) {
+    /* bits 16,17,18,19 = 1111 or 0000 invalid bitrate */
     return FALSE;
   }
   if( ((head>>10)&0x3) == 0x3 ) {
